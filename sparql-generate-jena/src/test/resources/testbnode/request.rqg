BASE <http://example.org/> 
PREFIX ite: <http://w3id.org/sparql-generate/ite/>
PREFIX fn: <http://w3id.org/sparql-generate/fn/>
PREFIX country:<http://loc.example.com/city/>
PREFIX schema: <http://schema.org/>
PREFIX wgs84_pos: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX gn: <http://www.geonames.org/ontology#>
PREFIX transit: <http://vocab.org/transit/terms/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> 
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>


GENERATE { 
 ?p1 foaf:name ?name1 ;
     foaf:knows ?p2 .
 ?p2 foaf:name ?name2 .
}
ITERATOR ite:XPath(?msg,"/relations/person") AS ?person1
ITERATOR ite:XPath(?person1,"/person/knows") AS ?person2
WHERE {
 BIND( fn:XPath(?person1, "/person/@name")  AS ?name1 )
 BIND( fn:XPath(?person2, "/knows")  AS ?name2 )
 BIND( fn:bnode( ?name1 ) AS ?p1 )
 BIND( fn:bnode( ?name2 ) AS ?p2 )
}